(ns advent-2018.day-2
  (:require [advent.util :as common]
            [clojure.string :as str]
            [clojure.core.matrix :as matrix]))

(defn parse [s]
  (str/split-lines s))

(def data "ybruvapdgixszyckwtfqjonsie\nmbruvapxghslyyckwtfqjonsie\nmbruvapdghslzyckwtkujonsie\nrwruvapdghxlzyckwtfqjcnsie\nobruvapdgtxlzyckwtfqionsie\nlbruvapdghxqzyckwtfqjfnsie\nmbrunapdghxlzyccatfqjonsie\nmbruvapdghxlzyokltfqjdnsie\nybruvapdghxlzmckwtfqjmnsie\nmbruwaadghxdzyckwtfqjonsie\nmuruvapdghxlzyckvtfqjonsim\nmbruvapdghxlkyckwtxqjonjie\nmbruvaqdghxlzyckwtfqjrnnie\nmwruvapdghdlzyckttfqjonsie\nmbruvapdgtelzyckwxfqjonsie\nmbruvapdohxlzvckwtfqjonhie\nmbrugapdgbxlzyckwtfqjynsie\nmbruvapdghxlzyckwtlqjonjiu\nmbruvapwghxlzyckwafqjonbie\nwbruvapdghxlhyckwtfqjonsii\nmbruvapdghxlzyckwtcqnonsiq\nmbyuvapighxlzybkwtfqjonsie\nmbrrvapdghxvzyckwtfqjonsio\nmhruvapdghrlzyckwtfzjonsie\nmtruvapvghxlzyckwtfnjonsie\nmmrlhapdghxlzyckwtfqjonsie\nmbruvapdgpxlzyjkwtfqjovsie\nmbrucapdghxlzymkwtzqjonsie\nmbeuvafdghxlzyckwtfqjonwie\nmbruvapcghxlayckwtfqjonsii\nmbruvabdghxlzyckwtfqyansie\nmbruvjpdghxlzyckwtfqgfnsie\nlbruvapdghxlzyckwtfqjonriv\nmbrupapdghxlzycjwtfqronsie\nmbpuvapdthxlzymkwtfqjonsie\nmbiuvapdgixlzyckwxfqjonsie\nmbruvapdghxyzyckwtfcjonsbe\nmbrurapkghxlzyckwtfqjonzie\nmbrufapdrhxlzyciwtfqjonsie\nmbruvapdghxlzbckwtfqjoisae\nubruhapdghxlzuckwtfqjonsie\nmbruvapdjhulzyckwtfqjonshe\nmbruwapdgyxlzyckntfqjonsie\nmwruvapdghplzyckwtfqjonsme\nmbruvapjghtlzyckwtfqgonsie\npbruvapdghhlzyckwtfrjonsie\nmbruvgpdihxqzyckwtfqjonsie\nmbruvahdohxlzyckwtfijonsie\nibuuvapdghxlzyckwtfqjofsie\nmbruvandghxlzyckwtfqjrnxie\nmbrjvlpdghxlzyckwgfqjonsie\nmbruvapogfxlzyckotfqjonsie\nmbruvrpdghxlzyckutfejonsie\nmbruvbpdghxlzyhkwtfqjonsip\nmbruvapdghxlzyckmnfqjensie\nmbruvapdghvlzyckwtfqjowsix\nmbruvakdgholzwckwtfqjonsie\nmbruvapdghxlzackwtfqconsae\nmbruvapdghxlzyqvwtfqjlnsie\nmprrvapdgfxlzyckwtfqjonsie\nmbrunacdghxlhyckwtfqjonsie\nobruvapdgsxlzyckwtfqjonvie\nmurcvapdghslzyckwtfqjonsie\nmbruvapdghxlzyzkwmftjonsie\nmbrwvapdgtvlzyckwtfqjonsie\nmbxuvapdghxlzqcnwtfqjonsie\nmbruvaddghxboyckwtfqjonsie\nmhruvwndghxlzyckwtfqjonsie\nmbrdvapdghxlzyckwmpqjonsie\nmbruvapdgyxlzyckizfqjonsie\nmbruvapdghxlzlckwtfqeowsie\nmbruvbpdgrxlzyckwtfqjonsxe\nmbruqapoghxlzyckwtvqjonsie\nmbouhapdghmlzyckwtfqjonsie\nmbruvapjghxidyckwtfqjonsie\nmbsuvapkghxlkyckwtfqjonsie\nmbruvlpdghxlzycrwtfqjonsis\nmcrueapdghxlzyckwtfqjynsie\nmuruvapngbxlzyckwtfqjonsie\nmbruvapdghxlzycawtfyjojsie\nmbruvbpdghxczyjkwtfqjonsie\nybduvapdghxnzyckwtfqjonsie\nmbruvbpdghxlzyckwtfbjousie\nmbouvapdghxlzycbwtfqponsie\nmbruvaedghplzycgwtfqjonsie\nmbrhvapdghxlzyckytfqjgnsie\nmbruvapdqbxleyckwtfqjonsie\nmbruvapddhhldyckwtfqjonsie\nmbruvapdghxlwrckwtfqjondie\nmbruvapdmhxlzyckwtfqkonsve\nxbbuvapdghxlzyckwtfkjonsie\nmbruvapdghxlzyckwcfqjunkie\nmbruvapdghxlzyckwtfqxonfib\nmbrtvapkghxlzyckwtfqeonsie\nmbruvazdghxldymkwtfqjonsie\nkbruvapddhxlzfckwtfqjonsie\nmbouvapdghxlpyckwtfqjoosie\nmbauvapdghxlzyckwtfqjszsie\nmbruvapdghtlzyckntfqtonsie\nmbruvipdggxlzbckwtfqjonsie\nmbruqapdghrlzyckwtfqjznsie\nmyruvacdghxlzyckwifqjonsie\nmbruvapdghxlzuckwtfkjocsie\nmwjuvapdghxlzyckwtfqjonsxe\nmbruvapxghxlzickwtfqjobsie\nmbrupapdghxtlyckwtfqjonsie\nmeruvapdjjxlzyckwtfqjonsie\nmbruvkodghxlzyckwofqjonsie\nmbruvapdgexlzyckwtgkjonsie\nmbruvapwghxlzyckwtcqjonsiw\nmbruvapdghxlzykkwtfqtoxsie\nmbruvapdahxlzycgwtfwjonsie\nmbruvapdgwxlhyckhtfqjonsie\nmbruvapbghxlzycbhmfqjonsie\nmbruvapdghxvzyzkwtfqjonsin\nmbrcvapdqhxlzyckwyfqjonsie\nzbruvaxdghxlzyckwgfqjonsie\nmtruvapdghxlilckwtfqjonsie\nbbruvapdghxlzyckwtfmjonsxe\nmbruvajdghxlzyckwtfqfwnsie\nmbruvapdgkxlzyckwtfqionpie\nrbruvapdghxlryckwdfqjonsie\nmbruvandghxlzyckwmfvjonsie\nmbruvahdghxlzeckwtfqjonsme\nmbruvnpcghxlzyckwtfqjobsie\nmbruvapdghqlzyckwtfbjonsiy\nmbruvavdghxlzyckwufqjodsie\nmbruvapdghxlzyckwtfzmovsie\nmbruvlpdghxuzyckwtfqjoesie\nmbruvopdghxlzycwwtfqjansie\nobruvapdghglzybkwtfqjonsie\nmbpuvlpdghxlcyckwtfqjonsie\nmbruvaidghxlzyckwtfmjonoie\nmbruvapdihxzzyckwtfqjonsiy\nmbquvapdghxlzyckwtfqconsme\nmbruvapdghslzyckqtfqjojsie\nmbrzdapdghxmzyckwtfqjonsie\nmwruvapdghxozyckwtfqjonsxe\nmuruvapdgfxlzyckwtfqjojsie\nwtruvapdghxlzyckvtfqjonsie\nmbruvapdghxlzyckysfqjxnsie\nmbruvrpdghxczyckktfqjonsie\nmbquvapdghxlryckwtfqjonsne\nmbruvapdghflzycvwtfqjpnsie\nmbruvapughclzyckwtfqjonsin\nmbrhvapdghxlpyckwtfqjonsre\nmbruvapdgtxlzyckwtfqjoosit\nmbrupapnghxhzyckwtfqjonsie\nmmvuvapdvhxlzyckwtfqjonsie\nmbruvaptghxlzyckwtfqjotsse\nmgruvapvghxlzyckwtfqjonsix\nmbrupapdghxszyckwtfqjunsie\nmbruvkpdghelzyckwtfqjpnsie\nmbruvrrdghjlzyckwtfqjonsie\nmbruvapdghnlzyckwtfkjonsze\nmbruvwpdghxlzyckwtfqhoysie\nmbrsvapdfhxlzyckwtfqjobsie\nmbruvapdgexezymkwtfqjonsie\nybruvapdghxlzyckwtfqxonsiw\nmrruvapdghxdzyckwtfqjossie\nmbruvapdghtlzyckwtfqconsiu\nmbrpvapdghxlzlckwpfqjonsie\nmbruvjpdghslzyckwtfqjjnsie\nmhruvapoghxlzyckwtfvjonsie\nmbrubqpdghvlzyckwtfqjonsie\nmbruvapdghxlzackwtfqconsiw\nmbruvapdgnxlzkckwtfqjdnsie\nmbrudapgghelzyckwtfqjonsie\nmbruvapdghxlzlakwbfqjonsie\nmbpuvapdghxlzyckwtuqjonjie\nabruvapdghxlzykkwtfqjonzie\nmbrupupdghxlsyckwtfqjonsie\nmbrsvupdghxlzyckwtfqjonkie\nmxruvgpdghxllyckwtfqjonsie\nmbrnvapdghxlzycbwtfqfonsie\nmbrbxapdghxlzyckttfqjonsie\nmbnuvapdghxlzyxkwtmqjonsie\nmbrfvapdghjlzickwtfqjonsie\nmbhuvupdghxlzyxkwtfqjonsie\nmbrcvapdghxluyckwtfqjznsie\nmbruvapdghxlzyckwofqjoxsiz\nmbrevapdghxloyckwtfqjonnie\nmbruvipdghnlzyckwtfqjopsie\nmbxxvaptghxlzyckwtfqjonsie\nmbruvcpdghxlztckwtjqjonsie\nmqruvlpdghxlzyckotfqjonsie\nmbruvapdgqxlzyckwtfqjpvsie\nmbruvapdgvxlzyjkwtfqjbnsie\nmbruvapdghxlgyckwtfqcocsie\nmbruvapdghxkwyckwtfqjoqsie\nmbrgvavdghxlzyckwxfqjonsie\nqbruqapdgvxlzyckwtfqjonsie\nmbauvapdghxlzgckwtfqjunsie\nmbruvapdgdxluyckwtfqjoosie\nmbruvapdghxlzykkwtfqwobsie\nmbruvapdghxlzhcnwtfqjonqie\nmbruvapdghxlzycbhmfqjonsie\nmbruvapdghxluyczwtfqjontie\nmbruvapnghxlzyckwnfqjonbie\nmoruvapdghxlzcckwtfqponsie\nmbruvapfgxxlzyckwtfqjunsie\nmbruvapdghxlryckvtfejonsie\nmbrzvapdghxlzvcbwtfqjonsie\nmbruvapdgqxlzyckwcfqjonsce\nabruvupdrhxlzyckwtfqjonsie\nmbrubaptghxlzyckwtfqjondie\nmgruvapdgpxlzyckwtfijonsie\nmbruvapdghxczlckwtfujonsie\nmbruvapdgmmlzyckwtfqjonsir\nmbruvapdhhxltyckwtfdjonsie\nmbruvapdghxlzyckwtfdjjnste\nmbrdvzpdghxlcyckwtfqjonsie\nmbruvapdghxlzyckwtnqbonsim\nmbrovapdghxlzyckwtfpjousie\nmymuvapdghxlzyjkwtfqjonsie\nmbpuvapdghxlzyckwtfljcnsie\nmbrxvapdghxlzyclwtfqjonpie\nmbrueapdghxlzyckwtfqjopsia\nmbruvapdghxlzycdwtfqjbfsie\ntbruvavdghxlzyckwtmqjonsie\nmbduvapdghxlzyckwrfqjrnsie\nmkrsvapughxlzyckwtfqjonsie\nmbruvapdghylzyckwtfqtolsie\nmgruvapdglxldyckwtfqjonsie\nmbrunapdghclzyckwtfqjonsiy\nmbruvapdgrxlxyckwtfgjonsie\nmbruvapdghxpzbckftfqjonsie\nmbruvcpdghxyzyckotfqjonsie\nmbruvapdghxlsyckwtfqcqnsie\nmbruvapdghxlzzckwtfqjonskf\nmbruvppdghxlzfckwtfqjgnsie\nmbhuvapdghxlzytkwtfqjonoie\nmbruvapdghxlzvrkwtfqjjnsie\nmbmuvapdghxuzyckwtfqjonsze\nmbruvapdghnlzycnwtfqjonsil\nmbruvapdgholzyckitfqjonsia\nmbruxapdghxlmyckwtfqbonsie\nmbauvapdgholzyckwtfqjolsie\nmbruvapdghxlzyckwtfqjotslq\ndbrutapdghxlzyckwtfqjonsiv\nmbruvapdzhxlyyckwtfbjonsie\nmmruaapsghxlzyckwtfqjonsie\nmbruvaldgqxqzyckwtfqjonsie\nmbruvaodghxdzyjkwtfqjonsie\nmbrcmatdghxlzyckwtfqjonsie\nmbrqvapdgtxlzycewtfqjonsie\nmjruvapdghzlzyckwtfqjonrie\nmbruvapdghxopcckwtfqjonsie\nmbruvapdghxszycwwtfqjoqsie\nmbruvapdgoxezyckwtjqjonsie")
(def parsed (parse data))

(def test-data "abcde\nfghij\nklmno\npqrst\nfguij\naxcye\nwvxyz")
(def parsed-test (parse test-data))

(defn score-token [t]
  (let [counts (set (vals (frequencies t)))]
    [(if (contains? counts 2)
       1
       0)
     (if (contains? counts 3)
       1
       0)]))

(defn part-1 []
  (apply * (reduce matrix/add
                   [0 0]
                   (map score-token
                        parsed))))

(defn delete-char-at [^String s ^Long i]
  (.toString (.deleteCharAt (StringBuilder. s)
                            i)))

(defn part-2 [in]
  (first (mapcat (fn [i]
                   (common/duplicates (map #(delete-char-at % i)
                                           in)))
                 (range (count (first in))))))
